# 论文阅读笔记

## 电力工控系统攻击渗透技术综述

**摘要：**

对网络入侵行为和网络攻击技术进行研究，也是确保电力工控系统网络安全的关键。文章首先根据
攻击机理`对现有的电力工控系统攻击渗透技术进行总结及分类`；其次，`针对4 种典型攻击技术，深入`
`研究其原理、方法和规律。`文章对电力工控系统安全防护技术的研究提供理论帮助，对全面提升电力
工控系统的安全防御具有重要的意义和实用价值。

### **攻击技术分类：**

+ 拒绝服务攻击（Denial of Serveice,DoS）

  目的：拥塞网络、耗尽系统资源、过载资源或锁死系统应用

  + Teardrop（泪滴）攻击：利用TCP/IP协议栈的漏洞向目标机器发送异常或者不合法的的数据包碎片，尝试在重组IP数据包碎片的过程中出现相同的字段，最终导致系统崩溃。==（利用数据包中的数据重叠重叠出错）==

  + TCP-SYN Flood攻击：主要是利用TCP协议在建立连接过程中存在的缺陷，伪造了大量的TCP连接请求，耗尽攻击目标资源（CPU超负荷或内存空间不足），导致正常客户请求无法处理的攻击方法。==（利用TCP三次握手机制，耗尽可连接数）==

  + Land攻击：将源地址和目标地址都设置成为要攻击的主机的IP地址，攻击的结果就是导致目标主机向自己发送SYN-ACK请求包，建立一个空连接，攻击者每发送一个数据包，目标主机就会建立一个空连接，而且每一个空连接都将保留到超时。==（利用TCP三次握手机制，自己连接自己，耗尽当前可利用资源）==

  + Smurf攻击：

    >  1>黑客锁定一个被攻击的主机（通常是一些Web服务器）；
    >   2>黑客寻找可做为中间代理的站点，用来对攻击实施放大（通常会选择多个，以便更好地隐藏自己，伪装攻击）；
    >   3>黑客给中间代理站点的广播地址发送大量的**ICMP包**（主要是指Ping命令的回应包）。这些数据包全都以被攻击的主机的IP地址做为IP包的源地址；
    >   4>中间代理向其所在的子网上的所有主机发送源IP地址欺骗的数据包；
    >   5>中间代理主机对被攻击的网络进行响应。

    ==（利用ICMP协议，通过被劫持的中间代理，在子网内发送的源地址为想要DDOS攻击的机器ip的广播包，导致被攻击主机遭到大量的连接请求）==

  + Fraggle攻击：攻击者向广播地址发送UDP报文，目的端口号为7或者19，此报文的源地址伪装成受害者的IP地址。字符发生器协议作为测试功能是一种仅发送字符的服务，没收到1个数据包会随机反馈一些字符。广播域中启用了此功能的计算机在收到UDP报文后就会给受害者主机发送反馈信息，从未产生大量流量，未开字符发生器协议的主机会给受害者主机发送ICMP不可到达信息，仍然会消耗带宽。Fraggle 攻击实施过程中，也可以将源端口改为端口19，目的端口为7，这样会持续产生回应报文，生成足够多的无用数据流，最终耗尽网络可用带宽。

+ 利用型攻击

  利用型攻击是一类通过网络技术手段直接控制主机或服务器的攻击，是一种直接破坏电力工控系统的攻击行为

  + 口令猜测攻击：攻击者通过对主机中可利用的账号进行猜测，主要包括Telnet服务和NetBIOS服务，然后对计算机进行控制的攻击行为。==（主要就是根据收集到的社工信息，爆破密码）==

  + 缓冲区溢出攻击：利用漏洞进行的攻击行为，一般由地址空间错误引起。正在运行程序的关键数据很容易受到缓冲区溢出攻击的威胁，一旦数据内容发生改变，正在执行的指令很可能会转向运行非法的程序代码，进而造成用户的损失。==（二进制漏洞，PWN）==

  + 社会工程学攻击：

    攻击过程包括3 个步骤：收集信息、取得信任和实施攻击

  + 会话劫持攻击：将嗅探技术和欺骗技术结合在内的攻击技术手段。

    分类：中间人攻击：通信协议会话劫持（前提通过ARP欺骗和DNS欺骗）

    ​				注射型攻击：在正常的通信数据流中加入恶意数据

  + 重放攻击：又称新鲜因子攻击、重播攻击、回放攻击和复制攻击。攻击者通过窃取以前或者当前运行协议中的信息或信息片段，对当前运行的协议进行攻击的行为，主要是对身份认证的正确性进行破坏。重放攻击时最普遍、危害性最大的攻击形式之一。==（brupSuite-->repeater模块）==
  + 旁路控制攻击：利用设备在执行计算过程中泄露的信息，同时根据攻击方法的机理还需要对设备进行物理入侵，进而实现对加密设备进行破译的一种攻击方法。

+ 信息收集型攻击：常见的网络攻击形式，并不会对攻击目标造成直接尾害。主要是对目标主机或数据包的传输过程进行检查，进而获得一些隐藏信息，为下一步攻击计划做铺垫。

  + IP扫描攻击：IP扫描攻击是一种通过向网络区域发送探测报文，确定目标主机的攻击手段。

    ​							 端口扫描是一种信息采集技术，通过对端口扫描数据进行统计，可以有效识别恶意行为。

  + 利用信息服务的攻击方式：

    + DNS 域转换威胁存在的具体原因是：DNS 协议对更改、转换信息内容的用户会进行身份验证，攻击
      者可以借助此机会，仅通过一次信息转换即可获得局域网内部所有主机的名称和地址。
    + Finger 服务探测是指攻击者利用Finger 命令对Finger 服务器进行刺探，进而获得服务器中所有用
      户的信息的一种攻击行为。
    + LDAP 服务探测是指攻击者利用LDAP 协议获得网络内部系统中用户的信息.

+ 假消息型攻击：攻击目标一般是配置不正确的消息，攻击手段有DNS高速缓存污染、伪造E-mail

  + DNS高速缓存污染：攻击者在DNS授权服务器向DNS缓存服务器返回结果前，发送了伪造的响应包并攻击成功，则攻击者发送的错误的信息将被缓存DNS服务器记录，并发送至用户。即使授权服务器发出的正确响应包被送达，也将被丢弃。此时用户将被导向访问非法网站

    ![image-20210507162348476](%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0.assets/image-20210507162348476.png)

  + 伪造E-mail：伪造电子邮件一般是由于SMTP 协议没有对邮件发送方的身份进行验证，攻击者利用该漏洞伪造身份，发送伪造邮件，并在邮件内容中加载恶意链接，或在附件中加载特洛伊木马等，用户打开邮件点击链接或附件，计算机将被感染。

### **典型攻击技术机理分析：**

**SYN Flood 攻击：**

> SYN Flood 攻击也称为SYN 洪水攻击或SYN洪泛攻击，是一种典型的拒绝服务攻击，攻击者利用TCP 3 次握手的机会，向目标服务器发送大量的源地址不存在或不可达的SYN 报文请求，服务器收到后回复SYN+ACK 报文，却不会收到ACK 响应报文，服务器上将存在大量的半连接，最终，这些半连接将耗尽服务器的资源，导致正常的请求得不到回应。

**Web 攻击：**

+ SQL注入：一种典型的利用型攻击技术

![image-20210507163409796](%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0.assets/image-20210507163409796.png)

**漏洞自动利用：**

+ 漏洞攻击技术：典型的利用型攻击技术。包括漏洞挖掘和漏洞利用2种技术。
+ 漏洞自动利用技术：漏洞自动利用如可执行文件、源代码、补丁等给定的数据，自动生成便于利用该漏洞达到目的的数据或代码的过程。
+ 漏洞自动利用的过程：
  + 信息提取
  + 漏洞识别
  + 路径发现与状态求解
  + 代码生成

**APT攻击技术：**是一种综合型的攻击技术，利用钓鱼邮件、社会工程、木马、DDOS等已有的攻击技术实现其攻击目的。

+ APT攻击的特点：

  + 技术多样：技术先进、多重途径攻击、攻击过程复杂且灵活
  + 持续时间长：从搜集信息到入侵周期长
  + 威胁大：由专业黑客组织发起

  + 目的性强、规模性大、隐蔽性强、突发性强、危害性大、复合性高、并发性强、目标实体化及非对称化等

+ APT攻击过程：

  > APT 攻击是一种集合多种常见攻击技术进行综合攻击的攻击行为。结合多种攻击手段突破网络防御工程，一般是通过Web 渗透、发送钓鱼邮件、利用社会工程学技巧、安装木马程序等手段，实现提权控守，窃取核心机密信息，再实施网络攻击。

  1. 情报收集
  2. 代码上传
  3. 远程控制
  4. 横向渗透
  5. 数据外传

### 电力系统安全防护：

**1. 建立更加完善的安全管理体系**

**2. 强化安全技术措施**

漏洞自动利用？是



## 工业控制系统安全综述

本文列举了工业控制系统的安全威胁，着重阐述了工业控制系统信息安全关键防护技术，对不同的优缺点进行了比较和分析。

**工业控制系统与IT系统对比：**

| 对比项   | 工业控制系统                                                 | IT系统                                     |
| -------- | ------------------------------------------------------------ | ------------------------------------------ |
| 安全理念 | 可用性<--完整性<--保密性                                     | 保密性<--完整性<--可用性                   |
| 防护对象 | 既包含服务器、计算机等信息基础设施，又包含生产设备、控制系统等 | 主要保护计算机、网络设施等                 |
| 可用性   | 7d*24h连续工作                                               | 可承受重启系统等反映，通常可忍受可用性缺陷 |
| 通信协议 | 有专用通信协议和私有协议，如Modbus、OPC等                    | TCP/IP等通用协议                           |
| 部件寿命 | 一般15-20年                                                  | 一般是3-5年                                |
| 实时性   | 对实时性要求高，尽量避免传输延迟和抖动                       | 非实时性，允许传输延时和抖动               |
| 系统升级 | 兼容性差，软硬件升级困难，使用专用工具升级系统               | 兼容性好，软硬件升级频繁                   |
| 技术支持 | 一般供应商独立运行                                           | 允许多样化服务                             |

**工业控制系统面临的安全威胁：**

![image-20210510160649913](%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0.assets/image-20210510160649913.png)

**工业控制系统信息安全防护技术**

+ 工业防火墙——基于内置的通信协议保护模式，实现端口保护、数据包深度检查、协议识别和分析，它的功能模块主要是由数据包采集和控制模块、访问控制模块、过滤和报警模块组成。

  + 工业防火墙结构图

    ![image-20210510161850952](%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0.assets/image-20210510161850952.png)

  + 工业防火墙的研究进展

  + 工业防火墙的优缺点分析

    + 优点：
      1. 工业防火墙技术目前普遍采用自学习方法，生成新的防火墙规则，提高工业防火墙的自学习能力
      2. 运用白名单策略，可以有效降低防火墙的负荷;
      3. 为了提高拦截的效率，也实现了分散部署集中管控，基于应用层上数据包的深度检查和协议分析．
    + 缺点：
      1. 很难通过真实世界中的白名单来确定**是否仅在内部网络中传输了经过身份验证的流量**？？？
      2. 防火墙规则提取未包括工控协议应用层数据的值及合理取值范围等参数，以及关联规则等

+ 入侵检测——入侵检测是对入侵行为的发觉，并对此做出反应的过程。入侵检测位于防护线之后，作为第二道防线，可以及时发现入侵和破坏，以弥补静态防护技术的不足，减少工业控制系统安全事件造成的损失。

  + 入侵检测的研究进展
  + 入侵检测的优缺点分析
    + 优点
      1. 工控系统智能化的入侵检测系统技术普遍提高了系统的检测率，降低了误报率、漏报率，加快了检测速度。
    + 缺点
      1. 运用的AMPSO － BP 方法在缺少样本条件下，缺乏稳定性以及检测的时效性
      2. 建立基于SVPSO 的工控入侵检测模型在挖掘其中有效信息时缺乏说服力

+ 态势感知——在一定时间和空间范围内对环境中元素的感知，对其现状的理解，以及对其在未来状态的预测． 将其分为3 个级别．

  > 第1级：对环境中元素的感知，实现态势感知的第一步是感知环境中相关元素的条件、特征和动态。
  >
  > 第2级：对现状的理解。对不连贯的第1级元素的综合，以形成对环境和特定对象、事件或格式塔模式意义的整体理解。
  >
  > 第3级：未来状态的投射。综合要素的特征和动态以及对形式的理解（一级和二级态势感知），以提供环境要素未来行动的预测，以支持决策。

  + 态势感知的研究进展

    

  ![image-20210510191747991](%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0.assets/image-20210510191747991.png)

  + 态势感知的优缺点分析
    + 优点：
      1. 运用在工控系统领域的态势感知技术能有效的利用数据源中的信息对系统内存在的危险态势进行感知，可以很好地反应出系统的实时的安全状况，为安全管理人员提供可靠得到决策依据，并且通过降低数据维度，实现了时间复杂度的降低。
    + 缺点：
      1. 工控系统态势感知领域目前处于起步阶段，在态势感知的工控独特要求及针对性方法设计方面还有待完善

+ 安全审计——安全审计是基于第三方审核员来检查数据完整性和监控异常数据的1种方法。

  + 安全审计的研究进展

    安全审计技术是实现工控网络安全的基础技术，是工业防火墙和入侵检测之后的第3道防线，有效的保障工业控制系统网络安全。

  + 安全审计的优缺点分析

    + 优点：
      1. 设计的ICS信息安全审计系统能够提供十分丰富的审计报告
      2. 构建的基于IP协议分布式工业网络行为审计系统模型能够实现工业网络设备的IP化，全面采集到行为数据发送到审计中心
    + 缺点：
      1. 复杂的审计算法影响了处理速度，需要更高的网络吞吐量

  

## 工业控制系统安全综述——陶耀东，李宁，曾广圣

**本文主要内容：**==总结分析了==工控系统的结构资产、脆弱性、存在的威胁、安全措施与风险评估等内容；==提出了==四层功能的防免疫系统的安全管理模型，==并重点分析了==其中的关键防御技术，例如深度防御、防火墙、异常检测、Conpot（Control System Honeypot）、安全远程访问以及管理策略；==指出==工控系统安全将会是智慧城市、智慧制造与工业4.0等新兴技术的发展契机与最大挑战；最后结合国内工控安全布局规划，给出工控安全建议，并展望未来的发展前景。

> 工业控制系统（ICS）包括数据监控与采集系统（SCADA）、分布式控制系统（DCS）、可编程逻辑控制器（PLC）、智能终端、人机交互接口（HMI）等系统。

### 工业控制系统资产（ICS Asset）与安全需求

**精确的工控设备清单是工控安全的基础。**设备清单用于登记工控系统中的资产以及所处的安全状态。

> 工业控制系统包括：“硬件资源”、“软件资源”、“存储其中的数据资源”、“与工控系统相连的生产设备”以及“生产环境”。

+ 硬件资源：包括RTU（远程终端单元）、PLC、SCADA、IED（智能电子设备）、现场总线、主机、路由、网关等
+ 软件资源：组态监控软件、工控编程软件、通讯软件、互联网应用软件、办公软件、杀毒软件等

![image-20210520150627554](%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0.assets/image-20210520150627554.png)

### 分析工控安全面临的威胁

**威胁分五大类**：

1. 环境与自然威胁
2. 内部无意威胁
3. 内部有意威胁
4. 外部攻击
5. 第三方人员

**以工控系统为目标的攻击才是真正的威胁**，根据威胁源是否以破坏工控系统为目标，分为**“无意识威胁”**和**“恶意威胁”**。

威胁源层次图

![image-20210520151452473](%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0.assets/image-20210520151452473.png)

> 与传统IT安全需求CIA顺序不同，工控安全的安全需求排序是AIC（Availability、Integrity、Confidentiality），最重要的就是可用性。将攻击分为三类，分别是可用性攻击，如拒绝服务；完整性攻击，如SQL注入攻击、修改关键数据；机密性攻击，如未授权获取数据等。

+ 具体的攻击表示形式：
  + 重放攻击
  + 中间人攻击
  + 远程修改RTU逻辑
  + DOS攻击
  + 0-Day漏洞攻击
  + APT（Advanced Persistent Threat）高级持续性威胁
  + 挂马
  + 漏洞攻击
  + 恶意软件攻击
  + 网络钓鱼
  + 间谍软件
  + SPAM(搜索引擎垃圾技术)
  + SQL注入攻击
  + 端口扫描
  + 脆弱性扫描
  + 信息泄露
  + 社会工程学攻击

+ 智慧电网安全运行的威胁：
  + 第一是设备安全威胁：
    + 智能电网的智能终端、WSN的无线传感器被恶意盗窃和篡改信息或者自然灾害侵蚀与老化
    + 终端被安装“逻辑炸弹”
  + 第二是网络安全威胁：
    + 常见网络攻击包括：Sinkhole攻击、选择性转发攻击、Sybil攻击、Wormhole攻击、DOS攻击、信息泄露、恶意拖延、破坏智能电网节点之间的信息传输和交换，导致电网系统混乱崩溃。
  + 第三是数据安全威胁：
    + 稀疏秘密攻击（Sparse Stealth Attacks）、虚假数据注入攻击、数据泄露。他们篡改智能电网的发、输、配、用电数据，因为电网用户量大，数据多，这种修改方式难以察觉，往往引起长时间的管理混乱，不利于智能电网的健康运行。

**威胁源攻击系统一般步骤：**信息收集、网络扫描、账户破解、实施攻击

### 分析工控系统存在的脆弱性

**脆弱性：指计算机系统在硬件、软件、协议的具体实现或者系统安全策略上存在的不足或缺陷。**

+ 策略、政策以及管理的脆弱性
+ 工控平台、终端的脆弱性
+ 工控网络的脆弱性

**脆弱性具体表现在**：

+ 不恰当的输入验证
+ 许可、授权与访问控制不严格
+ 不恰当的身份验证
+ 验证数据真实性不足
+ 差的代码质量指标
+ ICS软件配置维护不足
+ 凭证管理不严
+ 使用的加密算法已过时
+ 网络设计孱弱
+ 审计问责制度羸弱

**以分布式控制系统（DCS）中的工业无线传感器为例：**

无线传感器主要是完成数据收集、数据传输与控制管理，是工业控制系统最基础构成

+ 政策脆弱性：新兴的无线网络需要新的通信协议与管理策略，目前处于空白阶段。
+ 平台终端脆弱性：传感器的工作环境恶劣伴随有强烈震动、高温高压、腐蚀性有毒气体等，处于无人维护，不可控环境中，还有新出现的硬件木马
+ 网络脆弱性：在通信上存在噪声、多信道干扰、能量衰减、信息容量下降等问题，另外工业控制信号都是实时信号，无线传输存在时延问题，采用高级加密与认证技术不合适，导致其易被恶意盗窃和篡改信息，因无线连接，任何在传输范围内的设备都可轻易接入网络，易被窃听，非法篡改数据，针对SCADA 攻击（ad-hoc CADA-tailored attacks），甚至破坏传感器和捕获传感器

### 工控系统的安全措施

#### 安全需求描述

> 工控系统的安全需要解决两类威胁，对于**“无意识威胁”**，构造防风、防水、防火避雷等物理环境与报警系统，以避免自然灾害；对于仪器老化等自身问题，采用PHM技术，监督预测管理设备的生命状态。对于**“恶意威胁”**源则需要用到多种安全技术。

当前最常用的安全技术是 `入侵检测、漏洞扫描、纵深防御技术`

漏洞扫描对0day漏洞无效，纵深防御防火墙只能防御来自外部的攻击，入侵检测只能单纯的检测异常行为，不能提高工控系统的“恢复能力”

完善的工控系统安全防御模型应具备四个层次功能：

1. 阻挡外部入侵
2. 检测内部异常
3. 快速恢复功能正常、稳定的生产环境
4. 智能化的实现以上三个防御过程

![image-20210520161832239](%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0.assets/image-20210520161832239.png)

+ 安全不可忽略管理因素 
  + 企业高管参与安全管理
  + 实现员工安全培训程序
  + 建立基于角色的访问控制机制
+ 安全需要知己知彼
  + 知己——安全的前提
    + 制作设备清单，保证任何一件设备都处于安全的状态
  + 知彼——主动防御
    + 蜜罐通过提前接触攻击行为可为工控系统添加一道额外的防线。
+ 网络分区管理，区域间布置防火墙

> 国际工控领域指导性文献深度防御架构，将ICS划分为外部区域集合、控制网络区、企业网络区、远程访问区与生产现场

![image-20210520163840891](%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0.assets/image-20210520163840891.png)

+ 安全的远程访问方法

  安全的远程访问是工控系统开放的基础，涉及两个方面：其一制定远程移动设备管理策略；其二要求远程访问过程安全，使用户像在专用网络访问一样，VPN技术无疑可以做到。

+ 漏洞管理

+ 异常检测与事件响应计划
  + 异常检查是对防火墙的补充，可检查内部攻击、异常，可检测跨防火墙攻击。
+ 态势感知
  + 态势感知指综合分析ICS 安全要素，评估ICS 的安全状况，预测其变化趋势，以可视化的方式展现给用户，
    并给出相应的应对措施和报表。
+ 审计技术
  + 工控系统信息安全审计系统，该审计系统主要由数据采集模块、内容检测模块、异常行为判断模块、行为处理模块、审计响应模块等组成。

+ 工控终端与传感器安全

#### 风险评估与风险管理

> 工控风险指的是威胁源利用工控系统存在的脆弱性给工控资产造成损失，破坏生产的可能性，工控的风险涵括四个要素：**资产、脆弱性、威胁，安全措施。**资产价值高增大风险，威胁源利用脆弱性是风险增大，安全措施可以减少脆弱性达到规避或降低风险的目的。
>
> 风险管理即综合考虑风险的四个要素，使这一可能性降低到可接受的阈值。风险量化评估与风险管理是ICS 信息安全研究的重要基础。

### 未来发展与总结建议

+ 未来发展

未来深度防御、防火墙、入侵检测、强口令、漏洞扫描等防御技术继续发挥重要作用；Conpot 蜜罐技术、安全远程访问策略、日志审计技术将在工控安全中进一步发展；今后伴随着工业大数据的推进，拟态安全、云计算云安全技术、可信计算技术与可信防御技术将成为工控安全领域新的研究热点。

![image-20210520212941823](%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0.assets/image-20210520212941823.png)

除了研究较好的工控安全策略之外，还应重点关注和思考一下问题：

1. 如何构建我国安全的工控架构，尤其是国家绿色能源建设——水电、智能电网平台。
2. 如何实现安全的终端技术，在保证实时性的要求下完成数据的快速加密认证，底层协议的标准化、安全化研究，保证传感网络的安全。
3. 将工控安全与工业大数据集合，构建包括网络安全与机械自身安全的全面工控安全平台，考虑如何实现CPS与PHM技术推广到工业生产端，为仪器做好健康监控管理
4. 考虑如何完善国家工控标准、人员管理方案，提高涉工控所有人员的安全意识。
5. 研究虚拟仿真技术，用低成本研究工控安全，研究虚拟蜜罐以及实验床仿真技术。
6. 将安全分布式管理，研究使用硬件完成安全功能，如硬件加密技术等。

+ 总结
  + 总结分析了工控系统的架构资产、面临的威胁、存在的脆弱性与安全措施等内容

